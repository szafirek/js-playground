window.requestAnimationFrame = (function(){
  return window.requestAnimationFrame ||
         window.webkitRequestAnimationFrame ||
         window.mozRequestAnimationFrame ||
         window.oRequestAnimationFrame ||
         window.msRequestAnimationFrame ||
         function(callback){
          window.setTimeout(callback,1000/60);
         };
})();

var cvs = document.getElementById("canvas");
var ctx = cvs.getContext("2d");
var img = document.getElementById("img");
img.src = "data:image/jpeg;base64,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";
var width = img.width, height = img.height;
cvs.width = 600;
cvs.height = 300*height/width + 300;
var points = [], pixels;
var mouse = {x: -1000, y: -1000, down: false};

var resize = function(){
  img = document.getElementById("img");
  width = img.width;
  height = img.height;
  cvs.width = 600;
  cvs.height = 300*height/width + 300;
};

function Point(x,y,color){
  this.x = x;
  this.y = y;
  this.originalx = x;
  this.originaly = y;
  this.color = color;
};

Point.prototype.draw = function(){
  ctx.fillStyle = this.color;
  ctx.beginPath();
  ctx.arc(this.x,this.y,4,0,Math.PI*2,true);
  ctx.closePath();
  ctx.fill();
};

var previewFile = function() {
  var preview = document.querySelector('img');
  var file    = document.querySelector('input[type=file]').files[0];
  var reader  = new FileReader();

  reader.onloadend = function(){
    preview.src = reader.result;
    resize();
    getPixels();
    drawNodes();
    clearTimeout(animate);
  }

  if(file){
    reader.readAsDataURL(file);
  }else{
    reader.src = "data:image/gif;base64,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L5cWQIMZUGAxSPpzJgI9XrGFcLLweEJGLCICkNShFpHkhGEz8Q0BRTkUfUGKDdiwBQYokTAqEAAcTuCG7LpD1MMFsrKXfdoBiMEDZpjBB4jAgCqMgADoKQABUhCBKugACVAYwxNeYIQuM/vc6E63utfN7na7+93wjre8503vetv73vjOt773ze9++/vfAA+4wAdO//CCG/zgCE+4whfO8IY7/OEQj7jEJ07xilv84hjPuMY3zvGOe/zjIA+5yEdO8pKb/OQoT7nKV87ylrv85TCPucxnTvOa2/zmOM+5znfO8577/OdAD7rQh070ohv96EhPutKXzvSmO/3pUI+61KdO9apb/epYz7rWt871rnv962APu9jHTvaym/3saE+72tfO9ra7/e1wj7vc5073utv97njPu973zve++/3vgA+84AdP+MIb/vCIT7ziF8/4xjv+8ZCPvOQnT/nKW/7ymM+85jfP+c57/vOgD73oR0/60pv+9KhPvepXz/rWu/71sI+97GdP+9rb/va4z73ud8/73j37/vfAD77wh0/84hv/+MhPvvKXz/zmO//50I++9KdP/epb//rYz772t8/97nv/++APv/jHT/7ym//8Sg8EADs=";
  }
}

var init = function(){
  getPixels();
  document.getElementById("inputImg").addEventListener("change",previewFile,false);
};

var getPixels = function(){
  clearCanvas();
  ctx.drawImage(img,0,0,300,300*height/width);
  pixels = ctx.getImageData(0,0,width,height).data;
  clearCanvas();
  getPoints();
};

var clearCanvas = function(){
  cvs.width = cvs.width;
};

var getPoints = function(){
  points = [];
  for(var y = 0; y < height; y+=16){
    for(var x = 0; x < width; x+=16){
      var position = ((width * y) + x) * 4;
      var r = pixels[position],
          g = pixels[position + 1],
          b = pixels[position + 2],
          a = pixels[position + 3];
      if((r > 240 && g > 240 && b > 240) || a === 0) continue;
      var color = ['rgba(',r,',',g,',',b,',',a,')'].join('');
      points.push(new Point(x+100,y+100,color));
    }
  }
};

var drawNodes = function(){
  drawLines();
  _.each(points,function(e){e.draw();});
};

var drawLines = function(){
  for(var i = 0; i < points.length; i++){
    var current = points[i];
    for(var j = 0; j < points.length; j++){
      if(i === j) continue;
      var other = points[j];
      var xdiff = other.x - current.x, ydiff = other.y - current.y;
      var distance = Math.sqrt(xdiff*xdiff+ydiff*ydiff);
      if(distance <= 24){
        drawLine(current,other);
      }
    }
  }
}

var drawLine = function(current,other){
  ctx.beginPath();
  ctx.moveTo(current.x,current.y);
  ctx.lineTo(other.x,other.y);
  ctx.strokeStyle = other.color;
  ctx.stroke();
};

cvs.onmousemove = function(e){
  mouse.x = e.offsetX;
  mouse.y = e.offsetY;
  mouse.down = true;
};

cvs.onmousedown = function(e){mouse.down = true;};
cvs.onmouseup = function(e){mouse.down = false;};

cvs.onmouseout = function(e){
  mouse.x = -1000;
  mouse.y = -1000;
  mouse.down = false;
};

var draw = function(){
  clearCanvas();
  update();
  drawNodes();
};

var update = function(){
  for(i = 0; i < points.length; i++){
    var distance; 
    var current = points[i];
    var diffx = mouse.x - current.x, diffy = mouse.y - current.y;
    var t = Math.atan2(current.y - mouse.y,current.x - mouse.x);
    if(mouse.down){
      distance = 3*200/Math.sqrt(diffx*diffx+diffy*diffy);
    }else{
      distance = 3*100/Math.sqrt(diffx*diffx+diffy*diffy);
    }
    points[i].x += Math.cos(t) * distance + (current.originalx - current.x) * 0.05;
    points[i].y += Math.sin(t) * distance + (current.originaly - current.y) * 0.05;
  }
};

var animate = function(){
  draw();
  requestAnimationFrame(animate);
}

init();
animate();
